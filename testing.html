<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>WalletConnect Base Tx (No Install)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<body>
  <button id="connectBtn">Connect & Send Tx on Base</button>

  <script type="module">
    import EthereumProvider from "https://unpkg.com/@walletconnect/ethereum-provider@2.11.1/dist/index.js";
    import { ethers } from "https://cdn.jsdelivr.net/npm/ethers@6.10.0/dist/ethers.min.js";

    const BASE_CHAIN_ID = 8453;

    const connectBtn = document.getElementById("connectBtn");

    connectBtn.onclick = async () => {
      // 1. Init WalletConnect provider
      const provider = await EthereumProvider.init({
        projectId: "77ea2d08d606710c846a4deec8579b65", // REQUIRED
        chains: [BASE_CHAIN_ID],
        showQrModal: true,
        methods: ["eth_sendTransaction"],
        events: ["accountsChanged", "chainChanged"],
      });

      // 2. Open wallet (QR / deep link)
      await provider.enable();

      // 3. Wrap with ethers
      const ethersProvider = new ethers.BrowserProvider(provider);
      const signer = await ethersProvider.getSigner();
      const from = await signer.getAddress();

      // 4. Simple Base transaction
      const tx = {
        from,
        to: "0x000000000000000000000000000000000000dEaD",
        value: ethers.parseEther("0.00001"),
        chainId: BASE_CHAIN_ID,
      };

      console.log("Prompting tx:", tx);

      // 5. Prompt wallet
      const sentTx = await signer.sendTransaction(tx);
      console.log("Tx hash:", sentTx.hash);
    };
  </script>
</body>
</html>
